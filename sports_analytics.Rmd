---
title: "Big Ideas in Sports Analytics and Statistical Tools for their Investigation"
authors:
  - name: Benjamin S. Baumer
    thanks: Use footnote for providing further information about author (webpage, alternative address)---*not* for acknowledging funding agencies. Optional.
    department: Statistical & Data Sciences
    affiliation: Smith College
    location: Northampton, MA 01063
    email: bbaumer@smith.edu
    ORCID: 0000-0002-3279-0516
  - name: Gregory J. Matthews
    department: Mathematics and Statistics
    affiliation: Loyola University Chicago
    location: Chicago, IL 60660
    email: gmatthews1@luc.edu
    ORCID: 0000-0002-8413-5097
  - name: Quang Nguyen
    department: Mathematics and Statistics
    affiliation: Loyola University Chicago
    location: Chicago, IL 60660
    email: nnguyen22@luc.edu
  - name: Katherine Evans
    affiliation: Monumental Basketball
    location: Washington, DC 20003
    email: kevans@monumentalsports.com
abstract: |
  Sports analytics---broadly defined as the pursuit of improvement in athletic performance through the analysis of data---has expanded its footprint both in the professional sports industry and in academia over the past 30 years. We connect four(?) big ideas that are common across multiple sports, and explore both the shared similarities and individual idiosyncracies of analytical approaches in each sport. While our focus is on the concepts underlying each type of analysis, any implementation necessarily involves both statistical methodologies and sources of data. Where appropriate, we outline how data, models, and knowledge of the sport combine to generate actionable insights. This paper should serve as a useful overview for anyone becoming interested in the study of sports analytics. 
keywords:
  - sports analytics
  - R packages
  - sports data
  - datasets
bibliography: [refs.bib, pkgs.bib]
biblio-style: unsrt   # use apa for WIRE
output: rticles::arxiv_article
---


```{r setup, echo=FALSE, message=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  fig.align = 'center'
)
library(tidyverse)
```

```{r pkg}
knitr::write_bib(
  c(
    "Lahman", "pitchRx", "retrosheet",
    "teamcolors",
    "ggplot2",
    "BradleyTerry2"
  ),
  file = "pkgs.bib"
)
```

```{=latex}
\newcommand{\pkg}[1]{\textbf{#1}}
```


> Charge: Given your expertise and background, a review article from your group related to the topic of Statistical tools for sports analytics (e.g. baseball) would significantly contribute to WIREs Computational Statistics.
>
> The article should critically present the current state-of-the-art research, include opposing viewpoints, and identify challenges and opportunities.


**Remember that you are writing for an interdisciplinary audience. Please be sure to discuss interdisciplinary themes, issues, debates, etc. where appropriate.** Note that the WIREs are forums for review articles, rather than primary literature describing the results of original research.

## Article Category

- Overview


## Graphical/Visual Abstract and Caption

> Include an attractive full color image to go under the text abstract and in the online Table of Contents.
You will also need to upload this as a separate file during submission.
It may be a figure or panel from the article or may be specifically designed as a visual summary. While original images are preferred, if you need to look for a thematically appropriate stock image, you can go to pixabay.com (not affiliated with Wiley) to find a free stock image with a CC0 license. Another option you have is to utilize professional illustrators with Wileyâ€™s Graphical Abstract Design service.

> Size: The minimum resolution is 300 dpi. Please keep the image as simple as possible because it will be displayed in multiple sizes. Multiple panels and text other than labels are strongly discouraged.

> Caption: This is a narrative sentence to convey the article's essence and wider implications to a non-specialist audience. The maximum length is 50 words, but consider using 280 characters or less to facilitate social media sharing, which can increase the discoverability of your article.

# Introduction

> Introduce your topic in ~2 paragraphs, ~750 words.

> While Wiley does consider articles on preprint servers (ArXiv, bioRxiv, psyArXiv, SocArXiv, engrXiv, etc.) for submission to primary research journals, preprint articles should not be cited in WIREs manuscripts as review articles should discuss and draw conclusions only from peer-reviewed research. Remember that original research/unpublished work should also not be included as it has not yet been peer-reviewed and could put the work in jeopardy of getting published in the primary press.




- [CRAN Task View SportsAnalytics](https://github.com/beanumber/ctv-sportsanalytics)

# The expected value of a possession

In many sports, the first step towards an analytical understanding of the game is the estimation of the expected value of a game state at any given point in a sporting contest. 

Mathematically, we define $X$ to be a random variable indicating the the value of a particular game state for a team over some determined amount of time (e.g. remainder of game, quarter, period, or inning). 
Let $s \in S$ be a tuple that encodes the *state* of a game. 
Then our task is to estimate:
$$
  \mathbb{E}[X | s] \,,
$$
for any state $s \in S$, where $S$ is the set of all possible states. 

## In baseball, the expected run matrix

For clarity, we start with baseball due to the discrete nature of the sport. 
In baseball, $s$ is typically determined by two factors: the configuration of the runners on base (there are 8 possibilities) and the number of outs (3 possibilities). 
Thus, there $|S| = 24 = 8 \cdot 3$ basic states of an inning in baseball (25, if you include the absorbing state of 3 outs), and we are often interested in the number of runs that will be scored from some state until the end of the inning. 
In this example using baseball, $\mathbb{E}[X | s] \,$ is the expected number of runs scored between now and the end of the inning given that the inning is currently in state $s$. 
The collection of estimates $\mathbb{E}[X | s]$ for all 24 states is called the *expected run matrix* [^matrix], and it is foundational in baseball analytics. 
Figure \ref{fig:lindsey} shows a reproduction of Lindsey's original expected run matrix. 

[^matrix]: There is no inherent dimensionality to $\mathbb{E}[X | s]$. The *matrix* nomenclature stems from its values typically being displayed in $8 \times 3$ grid. However, when computing with $\mathbb{E}[X | s]$, it is most often convenient to treat it as a $24 \times 1$ vector. 


```{r lindsey, out.width="90%", fig.cap="Table 1 from Lindsey's original paper. The column labelled $E(T, B)$ gives the expected run matrix as a vector, based on Lindsey's analysis of Major League Baseball data from 1959 and 1960. "}
knitr::include_graphics("lindsey_table1.png")
```


Early work on this topic can be found in @lindsey1963investigation, who used play-by-play data to compute an empirical estimate for the mean number of runs scored in the remainder of the inning for each of these 24 possible states of an inning. 
This line of work led to analysis of all types of common baseball strategies. 
For example, many baseball teams elect to attempt a sacrifice bunt with a runner on first and no one out in the inning, with the goal of moving the runner to second base, at the cost of the batter being out. 
@Tango2007book (and many subsequent analyses), conclude that the sacrifice bunt is rarely worth it, because most teams would be expected to score more runs with a runner on first and no outs than they would with a runner on second and one out. 

It is worth emphasizing that the values in $\mathbb{E}[X | s]$ are estimates, and the precision of those estimates has many subtleties. 

First, the values within the expected run matrix change over time. 
For example, any estimation of the values in the expected run matrix based on data from a high-scoring era (e.g., the early 2000s) will yield different values than equivalent analysis in a low-scoring era. 
In a high run-scoring environment, where there are many home runs, the value of a walk may be higher, since a player who walks is more likely to score on a subsequent home run. 
Conversely, in a low run-scoring environment, stolen bases and sacrifice bunts may be comparatively more valuable. 
Thus, a careful estimate of $\mathbb{E}[X | s]$ would include a time parameter $t$, indicating when the estimate is appropriate. 

Second, the characterization of $S$ as having 24 states is only the simplest possible. 
The inning, or the score of the game, or even the weather, might reasonably be incorporated into $S$, as those conditions might reasonably affect the estimate of $\mathbb{E}[X | s]$. 
More definitively, the identity of the current batter, pitcher, or batter on deck, might also affect the estimate of $\mathbb{E}[X | s]$. 
Indeed, @Tango2007book show that when a particularly weak-hitting batter is up (i.e., the pitcher), a sacrifice bunt becomes much more effective strategy.  

See @Albert2001curve for a fuller discussion of the use of the expected run matrix in baseball and @marchi2018analyzing for examples of how to estimate the expected run matrix using Retrosheet data. 

## In other sports with discrete states

The concept of estimating the value of the state of a game is easily extended to other sports. 
In American football, $s$ is determined by down, yardage to the next first down, and field position. 

Numerous papers (see @lopez2020bigger for details) have used the analysis of the expected number of points to improve fourth down strategy. 
@goldner2017situational uses a similar framework.

@Pattani2012 describes ESPN's expected points metric.  

@CarrollPalmer1988 The hidden game of football.  Mentioned by Pattani and popularizing the idea of EPA.  

@Yurko2019, which uses an expected points model as part of the nfl war framework, uses down (1-4, seconds remaining in half, yards from endzone, yards to go (log), indicator for goal to go (GTG), and indicator for under 2 minutes (UTM).

@CarterMachol1971 estimate the expected points for 1st and 10 given a yard line (broken up into 10 yard chunks centered at a given yardline (e.g. 5, 15, 25, 35, etc. )).  This is wild that they did this in 1971!

## Sports with continuous states

Even in sports where the concept of a state is not so easy to define, like basketball, the value of a possession can be estimated with player tracking data [@cervone2016multiresolution].

See also @bornn2017studying.

@fernandez2021epvsoccer A framework for the fine-grained evaluation of the instantaneous expected value of soccer possessions

@decroos2019playeraction Actions Speak Louder than Goals: Valuing Player Actions in Soccer

# Win probability

A related, but different, concept is the notion of *win probability*, which is simply an estimate of the probability that either team will win the game, given its current state. Win probability provides a measure of the impact of sports plays and individual player contributions, as discussed in @Albert2015. Given its popularity, recent books on sports analytics often offers multiple chapters entirely on win probability. These include @Albert2001curve, @Schwarz2005numbers, @Tango2007book, @Albert2017handbook, and @Winston2022. In this section, we discuss notable previous work on win probability in baseball, football, basketball, and several other sports. 

## Baseball

@Albert2015 provided a historical overview of the use of win probability in baseball. This notion goes back to at least as early as @Lindsey1961, where the expected win probability after each inning was calculated based on the distribution of runs scored in each inning. @Mills1970 utilized win probability to introduce Player Win Average (PWA), a measure of a player's contribute to the game outcome. In particular, PWA was computed as 
$$
PWA = \frac{Win \ Points}{Win \ Points + Loss \ Points},
$$
where the win and loss points represent how much the player positively and negatively impact their team's probability of winning after each play.

## Football

In football, 

Burke WPA

http://www.advancedfootballanalytics.com/2010/01/win-probability-added-wpa-explained.html

@Lock2014 used random forests as a means for estimating WP before each play in a football game. 

@Yurko2019

@Yam2019 causal

nflscrapr, nflfastR, nflverse

@Yurko2020 going deep

@goldner2017situational

## Basketball

@Stern1994 brownian

@Deshpande2016 bayesian

@McFarlane2019 nba logistic

## Other sports

https://arxiv.org/pdf/2204.11777.pdf

@Brenzel2019 curling markov

@Maymin2020 esport!

# Team strength

A popular method for estimating team strength in sports is through pairwise evaluations. Perhaps the most famous probability model for predicting the outcome of a paired comparison is the Bradley-Terry model (BTM) [@Bradley1952]. For a pair of players (or teams) $i$ and $j$, let $\Pi_{ij}$ denote the probability that $i$ is preferred to $j$. Then the BTM is a logistic regression model with parameters $\beta_i, \beta_j$ such that

$$
log\left(\frac{\Pi_{ij}}{\Pi_{ji}}\right) = \beta_i - \beta_j
$$

Here, $\exp{\beta_i}$ is often viewed as a representation of player $i$'s ability. The BTM can be implemented in `R` [@Rcitation2022] via the \pkg{BradleyTerry2} package [@R-BradleyTerry2].

For example, ...


```{r btm, echo=TRUE}
library(Lahman)
library(BradleyTerry2)
# show BTM for Pirates vs. Yankees in 1960
# or Red Sox vs. Yankees in 2003/2004
```


@Elo1978

@Glickman1998 state-space model. 
See also @glickman2017estimating.

@Lopez2018 extension to @Glickman1998's framework

In soccer, @koning2017rating

## Other stuff

@marchi2018analyzing

@R-Lahman, @R-pitchRx, @R-retrosheet

Figure \ref{fig:chess-startup} shows a rendering of the starting chess board obtained via the \pkg{chess} package. 

```{r chess-startup, fig.cap="The starting chess board printed via the \\pkg{chess} package."}
#library(chess)
#Sys.setenv(RETICULATE_PYTHON = "my_env/bin/python3")
#game() %>% plot()
```


# Color palettes

@R-teamcolors provides color palettes for professional and amateur sports teams, as well as color and fill scale functions compatible with \pkg{ggplot2} [@R-ggplot2].
Figure \ref{fig:teamcolors} illustrates team color palettes for professional sports leagues. 


```{r teamcolors, warning=FALSE, fig.cap="Professional sports team color palettes provided by the \\pkg{teamcolors} package. ", fig.height=9}
teamcolors::show_team_col()
```


# Conclusion

Sum up the key conclusions of your review, highlighting the most promising scientific developments, directions for future research, applications, etc. The conclusion should be ~2 paragraphs, ~750 words total.



# Acknowledgments

List contributions from individuals who do not meet the criteria for authorship (for example, to recognize people who provided technical help, collation of data, writing assistance, acquisition of funding, or a department chairperson who provided general support), with permission from the individual. Thanks to anonymous reviewers are not appropriate.

# References {-}
